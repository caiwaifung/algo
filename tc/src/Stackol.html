<html><body bgcolor="#ffffcc" text="#000000"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td>Stackol is a programming language for printing strings. A program is a string containing 'A', 'B' or 'C' as characters (quotes for clarity). A program is evaluated from i = 0 to length(program)-1 using the following rules:<br></br>
<br></br>
<pre>
For i = 0 to length(program)-1 :
    If (i==0) or (program[i-1]!='B') then
        push program[i] to the top of stack1.
    Else
        push program[i] to the top of stack2.
    EndIf
    If (program[i]=='C') then 
        printAndEmptyStack(stack1)
        printAndEmptyStack(stack2)
    EndIf
EndFor</pre><br></br>
printAndEmptyStack(stack) is defined as follows:<br></br><br></br>
<pre>
While (stack is not empty):
    If (top character in stack) is 'A' or 'B' then
        Print (top character in stack)
    EndIf
    Remove the top character from the stack.
EndWhile
</pre>
<br></br>
We will consider a valid program to be one that ends with 'C'. We are interested in counting the total number of valid programs that can generate a given <i>output</i> string that contains only 'A' or 'B' characters. Since we would also like the program lengths to be reasonably small we will count only the programs that contain at most <b>k</b> 'C' characters.<br></br>
<br></br>
The <i>output</i> is given in fragments described by vector &lt;string&gt; <b>outputFragments</b>. In order to generate the <i>output</i>, concatenate the elements of <b>outputFragments</b>. Return the total number of programs that can generate the given <i>output</i> using at most <b>k</b> 'C' characters modulo 1000000007.</td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>Stackol</td></tr><tr><td>Method:</td><td>countPrograms</td></tr><tr><td>Parameters:</td><td>vector &lt;string&gt;, int</td></tr><tr><td>Returns:</td><td>int</td></tr><tr><td>Method signature:</td><td>int countPrograms(vector &lt;string&gt; outputFragments, int k)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>2.000</td></tr><tr><td>Memory limit (MB):</td><td>64</td></tr></table></td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td>The total number of characters in <b>outputFragments</b> will be between 1 and 2500, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>outputFragments</b> will contain between 1 and 50 elements, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>Each element of <b>outputFragments</b> will contain between 1 and 50 characters, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>Each element of <b>outputFragments</b> will contain only 'A' or 'B' characters.</td></tr><tr><td align="center" valign="top">-</td><td><b>k</b> will be between 1 and 10, inclusive.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;A&quot;}</pre></td></tr><tr><td><pre>2</pre></td></tr></table></td></tr><tr><td><pre>Returns: 3</pre></td></tr><tr><td><table><tr><td colspan="2">The 3 programs that produce "A" as output are:<br></br>
<br></br>
<pre>
CAC ACC AC
</pre>
</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;AAAA&quot;,&quot;BABA&quot;}</pre></td></tr><tr><td><pre>1</pre></td></tr></table></td></tr><tr><td><pre>Returns: 0</pre></td></tr><tr><td><table><tr><td colspan="2">There is no program that produces the given output.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;AB&quot;}</pre></td></tr><tr><td><pre>2</pre></td></tr></table></td></tr><tr><td><pre>Returns: 1</pre></td></tr><tr><td><table><tr><td colspan="2">The only possible program that can generate "AB" using at most two 'C' characters is: ACBC.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;AAABABABAABA&quot;, &quot;AA&quot;, &quot;BBAB&quot;}</pre></td></tr><tr><td><pre>3</pre></td></tr></table></td></tr><tr><td><pre>Returns: 94</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">4)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;AAAAAAAAAAAA&quot;,&quot;B&quot;}</pre></td></tr><tr><td><pre>4</pre></td></tr></table></td></tr><tr><td><pre>Returns: 120</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>
