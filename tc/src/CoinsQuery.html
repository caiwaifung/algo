<html><body bgcolor="#ccffcc" text="#000000"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td>Fox Ciel has n types of coins.
The types are numbered from 0 to n-1.
Each coin of type i has weight <b>w</b>[i] and value <b>v</b>[i].
Coins of the same type are considered identical.
Coins of different types are always distinct, even if they have the same weight and the same value.
Ciel has an unlimited supply of coins of each type.
<br></br>
<br></br>
You are given the vector &lt;int&gt;s <b>w</b> and <b>v</b>.
You are also given a vector &lt;int&gt; <b>query</b>.
Each element of <b>query</b> is a query you have to process.
<br></br>
<br></br>
For each integer S in <b>query</b>, solve the following problem:
Ciel wants to find a sequence of coins with total weight exactly equal to S.
If there is no such sequence, the answer is {-1, -1}.
If there are such sequences, Ciel wants to maximize the total value of the coins in the list.
Let X be the maximum total value that can be achieved.
Let Y be the number of sequences of coins with total weight S and total value X.
Then, the answer is {X, Y modulo (10^9 + 7)}.
<br></br>
<br></br>
Note that the order of coins in the sequence matters.
For example, the sequences {coin1, coin1, coin2} and {coin1, coin2, coin1} differ.
<br></br>
<br></br>
Return the concatenation of answers to all the queries.
(Thus, the number of elements in the return value should be twice the number of elements in <b>query</b>.)</td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>CoinsQuery</td></tr><tr><td>Method:</td><td>query</td></tr><tr><td>Parameters:</td><td>vector &lt;int&gt;, vector &lt;int&gt;, vector &lt;int&gt;</td></tr><tr><td>Returns:</td><td>vector&lt;long long&gt;</td></tr><tr><td>Method signature:</td><td>vector&lt;long long&gt; query(vector &lt;int&gt; w, vector &lt;int&gt; v, vector &lt;int&gt; query)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>2.000</td></tr><tr><td>Memory limit (MB):</td><td>256</td></tr><tr><td>Stack limit (MB):</td><td>256</td></tr></table></td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td>n will be between 1 and 100, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>w</b> will contain exactly n elements.</td></tr><tr><td align="center" valign="top">-</td><td><b>v</b> will contain exactly n elements.</td></tr><tr><td align="center" valign="top">-</td><td>Each element in <b>w</b> will be between 1 and 100, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>Each element in <b>v</b> will be between 1 and 1,000,000,000, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>query</b> will contain between 1 and 100 elements, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>Each element in <b>query</b> will be between 1 and 1,000,000,000, inclusive.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{2,3,5}</pre></td></tr><tr><td><pre>{20,30,50}</pre></td></tr><tr><td><pre>{1,2,3,4,5,6}</pre></td></tr></table></td></tr><tr><td><pre>Returns: {-1, -1, 20, 1, 30, 1, 40, 1, 50, 3, 60, 2 }</pre></td></tr><tr><td><table><tr><td colspan="2">For each coin in this test case we have value = 10*weight.
Hence, any sequence of coins with total weight S has the same total value 10*S.
Thus, all sequences that achieve the given total weight also achieve the maximum possible value.
<ul>
<li>There is no way to get a total weight of 1.</li>
<li>Ways to get a total weight of 2: {coin0}.</li>
<li>Ways to get a total weight of 3: {coin1}.</li>
<li>Ways to get a total weight of 4: {coin0, coin0}.</li>
<li>Ways to get a total weight of 5: {coin0, coin1}, {coin1, coin0}, {coin2}.</li>
<li>Ways to get a total weight of 6: {coin0, coin0, coin0}, {coin1, coin1}.</li>
</ul>
</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{7,4,3,8}</pre></td></tr><tr><td><pre>{10,20,17,13}</pre></td></tr><tr><td><pre>{10,100,1000,100000}</pre></td></tr></table></td></tr><tr><td><pre>Returns: {54, 3, 564, 33, 5664, 333, 566664, 33333 }</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{2,3,5}</pre></td></tr><tr><td><pre>{1,10,100}</pre></td></tr><tr><td><pre>{1,2,3,4,5,6}</pre></td></tr></table></td></tr><tr><td><pre>Returns: {-1, -1, 1, 1, 10, 1, 2, 1, 100, 1, 20, 1 }</pre></td></tr><tr><td><table><tr><td colspan="2">This time the values are different enough, so for each query there is only 1 optimal solution.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{1,1}</pre></td></tr><tr><td><pre>{1,1}</pre></td></tr><tr><td><pre>{10,20,30,40,50}</pre></td></tr></table></td></tr><tr><td><pre>Returns: {10, 1024, 20, 1048576, 30, 73741817, 40, 511620083, 50, 898961331 }</pre></td></tr><tr><td><table><tr><td colspan="2">Don't forget to mod.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">4)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{1}</pre></td></tr><tr><td><pre>{1000000000}</pre></td></tr><tr><td><pre>{1,1000000000}</pre></td></tr></table></td></tr><tr><td><pre>Returns: {1000000000, 1, 1000000000000000000, 1 }</pre></td></tr><tr><td><table><tr><td colspan="2">Return the exact value of X, not the remainder it gives modulo 10^9 + 7.
Only the value Y should be computed modulo 10^9 + 7.</td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>
