<html><body bgcolor="#ccffcc" text="#000000"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td>Hero has a tree.
As usual, the tree has n vertices labeled 0 through n-1.
Each edge of the tree has a one-character label.
You are given the description of the tree: a vector &lt;int&gt; <b>par</b> and a string <b>ch</b> with n-1 elements each.
For each valid i, the tree contains an edge between vertices (i+1) and <b>par</b>[i], and the label on the edge is <b>ch</b>[i].

For any ordered pair of vertices (x,y), the (x,y)-label is obtained as follows: 
Consider the unique simple path from x to y.
For each edge on this path write down its label.
The (x,y)-label is the concatenation of those edge labels, in order.

We say that the tree contains a string S if there is a pair of vertices (x,y) such that S is the (x,y)-label.

You are given a string <b>pat</b>.
This string has a particular property: there are no adjacent equal characters in <b>pat</b>.
Hero wants to choose a subtree of his tree.
(A subtree is any nonempty connected subgraph.
Two subtrees are distinct if their sets of vertices differ.)
The chosen subtree should <i>not</i> contain the string <b>pat</b>.
Count the number of ways in which Hero can choose his subtree, and return that count modulo 10^9 + 7.</td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>Substreeng</td></tr><tr><td>Method:</td><td>count</td></tr><tr><td>Parameters:</td><td>vector &lt;int&gt;, string, string</td></tr><tr><td>Returns:</td><td>int</td></tr><tr><td>Method signature:</td><td>int count(vector &lt;int&gt; par, string ch, string pat)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>2.000</td></tr><tr><td>Memory limit (MB):</td><td>256</td></tr><tr><td>Stack limit (MB):</td><td>256</td></tr></table></td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td><b>par</b> will contain between 1 and 100 elements, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>For each valid i, <b>par[i]</b> will be between 0 and i, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>par</b> and <b>ch</b> will contain the same number of elements.</td></tr><tr><td align="center" valign="top">-</td><td>Each character in <b>ch</b> will be between 'a' and 'z', inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>pat</b> will contain between 1 and 8 characters, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>Each character in <b>pat</b> will be between 'a' and 'z', inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>There will be no equals adjacent characters in <b>pat</b>.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{0,0,0}</pre></td></tr><tr><td><pre>&quot;aab&quot;</pre></td></tr><tr><td><pre>&quot;ab&quot;</pre></td></tr></table></td></tr><tr><td><pre>Returns: 8</pre></td></tr><tr><td><table><tr><td colspan="2">This tree contains the edges 1-0 (label 'a'), 2-0 (label 'a'), and 3-0 (label 'b').
Hero can choose a subtree that corresponds to one of the following 8 subsets of vertices:
{0}, {1}, {2}, {3}, {0,1}, {0,2}, {0,1,2}, or {0,3}.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{0,0,0}</pre></td></tr><tr><td><pre>&quot;aaa&quot;</pre></td></tr><tr><td><pre>&quot;b&quot;</pre></td></tr></table></td></tr><tr><td><pre>Returns: 11</pre></td></tr><tr><td><table><tr><td colspan="2">This tree has 11 different subtrees (including the tree itself), and Hero can choose any of them.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{0,1,2,3}</pre></td></tr><tr><td><pre>&quot;abab&quot;</pre></td></tr><tr><td><pre>&quot;ab&quot;</pre></td></tr></table></td></tr><tr><td><pre>Returns: 9</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{0,1,2,3,4,5,6,7,8}</pre></td></tr><tr><td><pre>&quot;ababababa&quot;</pre></td></tr><tr><td><pre>&quot;c&quot;</pre></td></tr></table></td></tr><tr><td><pre>Returns: 55</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">4)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{0,1,2,3,4,5,6,7,8}</pre></td></tr><tr><td><pre>&quot;ababababa&quot;</pre></td></tr><tr><td><pre>&quot;abab&quot;</pre></td></tr></table></td></tr><tr><td><pre>Returns: 34</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>
