<html><body bgcolor="#ffffcc" text="#000000"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><p>
There are N rooms in Maki's new house.
The rooms are numbered from 0 to N-1.
Some pairs of rooms are connected by bidirectional passages.
The passages have the topology of a tree.
That is, there are exactly N-1 of them and it is possible to go from any room to any other room by following some sequence of passages.
</p>
<p>
You are given two vector &lt;int&gt;s <b>a</b> and <b>b</b> that describe the passages.
For each valid i, there is a passage that connects the rooms <b>a</b>[i] and <b>b</b>[i].
You are also given two ints: <b>s1</b> and <b>s2</b>
The house has exactly two entrances from the outside.
One leads to the room <b>s1</b>, the other leads to the room <b>s2</b>.
</p>
<p>
Niko is helping Maki move into the new house.
Maki has exactly N pieces of furniture.
The pieces are numbered from 0 to N-1.
Niko will carry them into the house in this order.
Each piece of furniture must be placed into a different room.
Maki does not care which piece goes where, each of the N! permutations is allowed.
</p>
<p>
However, not all of those N! permutations are actually possible.
This is because the furniture is large.
As soon as a room contains a piece of furniture, it is impossible to move other pieces through this room.
Thus, Niko must place the furniture carefully.
Formally, she can place a new piece of furniture into the room x if and only if there is a path from one of the entrances to x that consists only of empty rooms.
(For any room x, there is exactly one path from <b>s1</b> to x and exactly one path from <b>s2</b> to x.
At least one of these two paths must be completely empty.)
</p>
<p>
Niko is smart and she will always place the furniture in such a way that she never gets stuck.
Thus, at the end each of Maki's rooms will contain exactly one piece of furniture.
</p>
<p>
Let X be the number of ways how the furniture can be arranged in Maki's house at the end.
As X can be large, calculate and return the value (X modulo 1,000,000,007).
</p></td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>TwoEntrances</td></tr><tr><td>Method:</td><td>count</td></tr><tr><td>Parameters:</td><td>vector &lt;int&gt;, vector &lt;int&gt;, int, int</td></tr><tr><td>Returns:</td><td>int</td></tr><tr><td>Method signature:</td><td>int count(vector &lt;int&gt; a, vector &lt;int&gt; b, int s1, int s2)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>2.000</td></tr><tr><td>Memory limit (MB):</td><td>512</td></tr><tr><td>Stack limit (MB):</td><td>512</td></tr></table></td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td>N will be between 2 and 3000, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>a</b> and <b>b</b> will contain exactly N-1 elements each.</td></tr><tr><td align="center" valign="top">-</td><td>Each element of <b>a</b> and <b>b</b> will be between 0 and N-1, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>The graph described by <b>a</b> and <b>b</b> will be a tree.</td></tr><tr><td align="center" valign="top">-</td><td><b>s1</b> and <b>s2</b> will be between 0 and N-1, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>s1</b> and <b>s2</b> will be different.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{0, 1, 2}</pre></td></tr><tr><td><pre>{1, 2, 3}</pre></td></tr><tr><td><pre>0</pre></td></tr><tr><td><pre>1</pre></td></tr></table></td></tr><tr><td><pre>Returns: 4</pre></td></tr><tr><td><table><tr><td colspan="2">Niko must fill the rooms in one of the following four orders: {3,2,1,0}, {3,2,0,1}, {3,0,2,1}, or {0,3,2,1}.
(Note that, for example, she cannot place a piece of furniture into room 2 before he places another piece into room 3.)</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{0, 1, 2}</pre></td></tr><tr><td><pre>{1, 2, 3}</pre></td></tr><tr><td><pre>0</pre></td></tr><tr><td><pre>2</pre></td></tr></table></td></tr><tr><td><pre>Returns: 9</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{0, 1, 1, 3, 3, 3, 6, 7, 6}</pre></td></tr><tr><td><pre>{1, 2, 3, 4, 5, 6, 7, 8, 9}</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>9</pre></td></tr></table></td></tr><tr><td><pre>Returns: 16000</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{0, 0, 1, 2, 3, 1, 2, 0, 6, 5, 10, 10}</pre></td></tr><tr><td><pre>{1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10, 11, 12}</pre></td></tr><tr><td><pre>3</pre></td></tr><tr><td><pre>6</pre></td></tr></table></td></tr><tr><td><pre>Returns: 310464</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">4)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{0}</pre></td></tr><tr><td><pre>{1}</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>0</pre></td></tr></table></td></tr><tr><td><pre>Returns: 2</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>
