<html><body bgcolor="#ffffcc" text="#000000"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td>Little Arthur loves numbers. This time he is playing a game called Number Labyrinth.
<br></br><br></br>
The game is played on an infinitely large grid; columns are numbered 0, 1, 2, .. from left to right and rows are numbered 0, 1, 2, .. from bottom to top. The cell in column x and row y is said to have coordinates (x, y). Each cell of the board either contains a positive integer or is empty. There are exactly N cells that contain numbers and their descriptions are given as vector &lt;int&gt;s <b>X</b>, <b>Y</b>, and <b>val</b>. For each i between 0 and N-1, inclusive, the i-th such cell has coordinates (<b>X</b>[i], <b>Y</b>[i]) and contains number <b>val</b>[i].
<br></br><br></br>
The goal of the game is to get from cell (0, 0) to cell (<b>xFinish</b>, <b>yFinish</b>) by performing valid moves. A valid move is a jump of length d in a horizontal or vertical direction from a cell with a number d; more formally, if Arthur's position is (x, y) and the cell contains a number d, he can move to cell (x - d, y), (x + d, y), (x, y - d), or (x, y + d). Note that an empty cell is a dead-end. Arthur is also not allowed to leave the board at any time, i.e., enter a cell (x, y) where x or y (or both) are negative.
<br></br><br></br>
Furthermore, before performing moves Arthur is allowed to write any positive integers in at most <b>K</b> empty cells.
<br></br><br></br>
Arthur of course wants to reach the goal of the game with the shortest possible path, i.e., the smallest sum of the lengths of jumps that lead from (0, 0) to (<b>xFinish</b>, <b>yFinish</b>).
<br></br><br></br>
However, finding a single shortest path in not a difficult task for Arthur. Thus, he is going to find all possible shortest paths. Given <b>X</b>, <b>Y</b>, <b>val</b>, <b>xFinish</b>, <b>yFinish</b>, and <b>K</b>, return the number of different shortest paths Arthur can obtain. Two paths are cosidered different if their respective sequences of jumps are different. Two jumps are different if they have different length or different direction. This number may be very big, so return it modulo 1,000,000,009. If no path exists return 0.
</td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>NumberLabyrinthDiv1</td></tr><tr><td>Method:</td><td>getNumberOfPaths</td></tr><tr><td>Parameters:</td><td>vector &lt;int&gt;, vector &lt;int&gt;, vector &lt;int&gt;, int, int, int</td></tr><tr><td>Returns:</td><td>int</td></tr><tr><td>Method signature:</td><td>int getNumberOfPaths(vector &lt;int&gt; X, vector &lt;int&gt; Y, vector &lt;int&gt; val, int xFinish, int yFinish, int K)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>2.000</td></tr><tr><td>Memory limit (MB):</td><td>64</td></tr></table></td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td>N will be between 0 and 40, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>X</b>, <b>Y</b>, and <b>val</b> will each contain exactly N elements.</td></tr><tr><td align="center" valign="top">-</td><td>Each element of <b>X</b>, <b>Y</b>, and <b>val</b> will be between 1 and 1000000 (10^6), inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>xFinish</b> and <b>yFinish</b> will each be between 1 and 1000000 (10^6), inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>K</b> will be between 0 and 10, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>All coordinates (<b>X</b>[i], <b>Y</b>[i]) will be distinct and different from (<b>xFinish</b>, <b>yFinish</b>).</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{}</pre></td></tr><tr><td><pre>{}</pre></td></tr><tr><td><pre>{}</pre></td></tr><tr><td><pre>3</pre></td></tr><tr><td><pre>3</pre></td></tr><tr><td><pre>2</pre></td></tr></table></td></tr><tr><td><pre>Returns: 2</pre></td></tr><tr><td><table><tr><td colspan="2">There is no way to reach the finish cell writing numbers in less than two cells. However, the finish can be reached by writing numbers in exactly two cells. The shortest possible path in this case is 6 and that can be obtained in two ways:
<br></br>
- writing 3 in cell (0, 0) and 3 in cell (0, 3), allowing him to perform jumps (0, 0) -> (0, 3) -> (3, 3);
<br></br>
- writing 3 in cell (0, 0) and 3 in cell (3, 0), allowing him to perform jumps (0, 0) -> (3, 0) -> (3, 3).</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{}</pre></td></tr><tr><td><pre>{}</pre></td></tr><tr><td><pre>{}</pre></td></tr><tr><td><pre>3</pre></td></tr><tr><td><pre>3</pre></td></tr><tr><td><pre>3</pre></td></tr></table></td></tr><tr><td><pre>Returns: 14</pre></td></tr><tr><td><table><tr><td colspan="2">The same situation as in the previous example, but this time there are 12 more paths possible if numbers are written in three cells. For example, Arthur can write 2 in cell (0, 0), 3 in cell (0, 2), and 1 in cell (3, 2) to enable path (0, 0) -> (0, 2) -> (3, 2) -> (3, 3).</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{2}</pre></td></tr><tr><td><pre>{2}</pre></td></tr><tr><td><pre>{1}</pre></td></tr><tr><td><pre>3</pre></td></tr><tr><td><pre>3</pre></td></tr><tr><td><pre>3</pre></td></tr></table></td></tr><tr><td><pre>Returns: 18</pre></td></tr><tr><td><table><tr><td colspan="2">This time one cell already contains a number enabling 4 new shortest paths.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{1, 3, 6}</pre></td></tr><tr><td><pre>{1, 3, 6}</pre></td></tr><tr><td><pre>{2, 2, 2}</pre></td></tr><tr><td><pre>5</pre></td></tr><tr><td><pre>5</pre></td></tr><tr><td><pre>4</pre></td></tr></table></td></tr><tr><td><pre>Returns: 210</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">4)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{1, 19, 20, 21, 21, 21, 20, 19, 19}</pre></td></tr><tr><td><pre>{1, 11, 11, 11, 10, 9, 9, 9, 10}</pre></td></tr><tr><td><pre>{1, 2, 2, 2, 2, 2, 2, 2, 2}</pre></td></tr><tr><td><pre>20</pre></td></tr><tr><td><pre>10</pre></td></tr><tr><td><pre>4</pre></td></tr></table></td></tr><tr><td><pre>Returns: 1778</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">5)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{13, 224, 77, 509, 1451, 43, 379, 142, 477}</pre></td></tr><tr><td><pre>{1974, 375, 38, 783, 3, 1974, 1790, 1008, 2710}</pre></td></tr><tr><td><pre>{30, 1845, 360, 11, 837, 84, 210, 4, 6704}</pre></td></tr><tr><td><pre>509</pre></td></tr><tr><td><pre>2011</pre></td></tr><tr><td><pre>10</pre></td></tr></table></td></tr><tr><td><pre>Returns: 196052726</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>
